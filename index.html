<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QPSRVD4KQW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-QPSRVD4KQW');
  </script>

  <!-- Title -->
  <title>Leveraging Analytic Gradients in Provably Safe Reinforcement Learning</title>

  <!-- Color scheme hint for browsers (affects form controls, scrollbars in some UAs) -->
  <meta name="color-scheme" content="light dark">


  <script>
    (function () {
      try {
        var stored = localStorage.getItem('color-mode');
        var systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        var mode = stored ? stored : (systemDark ? 'dark' : 'light');
        document.documentElement.setAttribute('data-bs-theme', mode);
      } catch (e) { /* fail silent */ }
    })();
  </script>

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Leveraging Analytic Gradients in Provably Safe Reinforcement Learning">
  <meta name="keywords"
    content="Robotics Control, Policy Learning, Reinforcement Learning, Differentiable Simulation, Safe Reinforcement Learning">

  <!-- Bootstrap core CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <!-- https://fontawesome.com/cheatsheet -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
    integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">

  <link rel="preload" href="pipeline.svg" as="image">
  <link rel="preload" href="main_results.svg" as="image">
  <link rel="preload" href="pipeline_dark.svg" as="image">
  <link rel="preload" href="main_results_dark.svg" as="image">


</head>
<style>
  /* Theme variable sets */
  :root[data-bs-theme="light"] {
    --tw-body-bg: #ffffff;
    --tw-body-color: #212529;
    --tw-nav-bg: #3070b3;
    --tw-link-color: #0a58ca;
    --tw-link-hover: #084298;
    --tw-code-bg: #f8f9fb;
    --tw-code-border: #e2e6ea;
    --tw-copy-btn-bg: rgba(255, 255, 255, 0.9);
    --tw-copy-btn-border: #d0d7de;
    --tw-copy-btn-hover-bg: #ffffff;
    --tw-copy-btn-active-bg: #eef1f4;
    --tw-copy-btn-success-bg: #d1e7dd;
    --tw-copy-btn-success-border: #9ac7b3;
  }

  :root[data-bs-theme="dark"] {
    --tw-body-bg: #1f2227;
    --tw-body-color: #e8e9eb;
    --tw-nav-bg: #306fb383;
    /* darker variant */
    --tw-link-color: #66b3ff;
    --tw-link-hover: #99ccff;
    --tw-code-bg: #25292f;
    --tw-code-border: #32363c;
    --tw-copy-btn-bg: rgba(37, 41, 47, 0.85);
    --tw-copy-btn-border: #3a3f46;
    --tw-copy-btn-hover-bg: #31363c;
    --tw-copy-btn-active-bg: #2a2e33;
    --tw-copy-btn-success-bg: #244d3b;
    --tw-copy-btn-success-border: #2d6f52;
  }

  /* Base body / text */
  html {
    scroll-behavior: smooth;
  }

  body {
    background: var(--tw-body-bg);
    color: var(--tw-body-color);
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
  }

  /* Navbar */
  .navbar {
    background: var(--tw-nav-bg) !important;
  }

  .navbar-brand {
    font-size: 1.35rem;
    font-weight: 600;
    letter-spacing: .5px;
  }

  .navbar-nav .nav-link {
    font-size: 1.1rem;
    text-decoration: none !important;
    transition: color .15s ease;
  }

  .navbar-nav .nav-link:hover,
  .navbar-nav .nav-link:focus-visible {
    color: #fff;
  }

  /* Optional toggle button style */
  .color-mode-toggle {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.5);
    color: #fff;
    font-size: .85rem;
    padding: .25rem .6rem;
    border-radius: .4rem;
    cursor: pointer;
    margin-left: 1rem;
    line-height: 1.1;
    transition: background .2s, border-color .2s;
  }

  :root[data-bs-theme="light"] .color-mode-toggle {
    border-color: rgba(0, 0, 0, 0.35);
    color: #212529;
  }

  .color-mode-toggle:hover {
    background: rgba(255, 255, 255, 0.15);
  }

  :root[data-bs-theme="light"] .color-mode-toggle:hover {
    background: rgba(0, 0, 0, 0.06);
  }

  /* Links */
  a {
    text-decoration: none;
    color: var(--tw-link-color);
    transition: color .15s ease, text-decoration-color .15s ease;
  }

  a:hover,
  a:focus-visible {
    text-decoration: underline;
    text-underline-offset: 3px;
    text-decoration-thickness: 2px;
    color: var(--tw-link-hover);
  }

  /* Code / BibTeX block */
  .code-block-wrapper {
    position: relative;
    margin-top: 0;
  }

  .bibtex-pre {
    background: var(--tw-code-bg);
    border: 1px solid var(--tw-code-border);
    border-radius: 6px;
    padding: 14px 56px 14px 16px;
    overflow: auto;
    font-size: 0.9rem;
    line-height: 1.4;
    margin: 0;
  }

  .bibtex-pre code {
    background: transparent;
    padding: 0;
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    display: block;
  }

  /* Copy button */
  .copy-icon-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: var(--tw-copy-btn-bg);
    border: 1px solid var(--tw-copy-btn-border);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
    border-radius: 4px;
    padding: 4px 6px;
    cursor: pointer;
    color: #bbb;
    line-height: 1;
    font-size: 14px;
    transition: background .15s, color .15s, border-color .15s;
    z-index: 2;
  }

  :root[data-bs-theme="light"] .copy-icon-btn {
    color: #555;
  }

  .copy-icon-btn:hover {
    background: var(--tw-copy-btn-hover-bg);
    color: #fff;
  }

  :root[data-bs-theme="light"] .copy-icon-btn:hover {
    color: #000;
  }

  .copy-icon-btn:active {
    background: var(--tw-copy-btn-active-bg);
  }

  .copy-icon-btn.copied {
    background: var(--tw-copy-btn-success-bg);
    border-color: var(--tw-copy-btn-success-border);
    color: #fff;
  }

  /* Emoji fallback */
  .emoji {
    font-family: "Twemoji Mozilla", "Segoe UI Emoji", "Noto Color Emoji", "Apple Color Emoji", "Android Emoji", "EmojiSymbols", sans-serif;
  }

  /* Responsive tweak for very small screens */
  @media (max-width: 575.98px) {
    .navbar-brand {
      font-size: 1.22rem;
    }

    .navbar-nav .nav-link {
      font-size: 1rem;
    }
  }

  /* --- Dark-mode helper for invert approach (Option A) --- */
  :root[data-bs-theme="dark"] img.theme-invert {
    filter: invert(1) brightness(1.15) contrast(0.95);
  }

  /* --- Theme Toggle Switch Styles --- */
  .theme-toggle-wrapper {
    user-select: none;
  }

  .theme-switch {
    position: relative;
    width: 54px;
    height: 28px;
  }

  .theme-switch input {
    opacity: 0;
    width: 0;
    height: 0;
    position: absolute;
  }

  .switch-slider {
    position: absolute;
    inset: 0;
    cursor: pointer;
    border-radius: 999px;
    background: linear-gradient(90deg, #3070b3, #243b55);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 6px;
    font-size: 14px;
    color: #222;
    transition: background .4s;
    border: 1px solid rgba(0, 0, 0, 0.25);
  }

  :root[data-bs-theme="dark"] .switch-slider {
    background: linear-gradient(90deg, #243b55, #141e30);
    color: #eee;
    border-color: rgba(255, 255, 255, 0.25);
  }

  .switch-slider .icon {
    line-height: 1;
    display: flex;
    align-items: center;
    pointer-events: none;
    opacity: 0.8;
  }

  .switch-slider .sun {
    font-size: 0.85rem;
  }

  .switch-slider .moon {
    font-size: 0.85rem;
  }

  .switch-slider::before {
    content: "";
    position: absolute;
    top: 3px;
    left: 4px;
    width: 22px;
    height: 22px;
    background: #fff;
    border-radius: 50%;
    box-shadow: 0 2px 5px rgba(0, 0, 0, .35);
    transition: transform .35s cubic-bezier(.55, .09, .68, .53), background .35s;
    z-index: 1;
  }

  :root[data-bs-theme="dark"] .switch-slider::before {
    background: #f5f5f5;
  }

  /* Checked (manual dark) moves knob to right */
  .theme-switch input:checked+.switch-slider::before {
    transform: translateX(26px);
  }

  /* Auto mode indicator button */
  .auto-btn {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.5);
    font-size: 0.65rem;
    padding: .25rem .55rem;
    border-radius: 999px;
    line-height: 1;
    cursor: pointer;
    letter-spacing: .5px;
    font-weight: 500;
    text-transform: uppercase;
    transition: background .25s, color .25s, border-color .25s;
  }

  :root[data-bs-theme="light"] .auto-btn {
    border-color: rgba(0, 0, 0, 0.45);
    color: #222;
  }

  .auto-btn:hover {
    background: rgba(255, 255, 255, 0.15);
    color: #fff;
  }

  :root[data-bs-theme="light"] .auto-btn:hover {
    background: rgba(0, 0, 0, 0.07);
    color: #000;
  }

  .auto-btn.active {
    background: rgba(255, 255, 255, 0.25);
    color: #fff;
  }

  :root[data-bs-theme="light"] .auto-btn.active {
    background: rgba(0, 0, 0, 0.1);
    color: #000;
  }
</style>

<body>
  <!-- End Google Tag Manager (noscript) -->
  <!-- <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"> -->
  <nav class="navbar navbar-expand-md navbar-dark">
    <div class="container">
      <a class="navbar-brand" href="#">Safe AGB RL</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggle"
        aria-controls="navbarToggle" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarToggle">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="#">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#Abstract">Abstract</a></li>
          <li class="nav-item"><a class="nav-link" href="#Paper">Paper</a></li>
          <li class="nav-item"><a class="nav-link" href="#Results">Results</a></li>
          <li class="nav-item"><a class="nav-link" href="#Additional Results">Additional Results</a></li>
        </ul>
        <!-- Theme toggle -->
        <div class="theme-toggle-wrapper ms-md-3 mt-3 mt-md-0 d-flex align-items-center">
          <div class="theme-switch">
            <input type="checkbox" id="theme-toggle" aria-label="Toggle dark mode">
            <label for="theme-toggle" class="switch-slider">
              <span class="icon sun"><i class="fas fa-sun"></i></span>
              <span class="icon moon"><i class="fas fa-moon"></i></span>
            </label>
          </div>
        </div>
      </div>
    </div>
  </nav>



  <div class="container" style="padding-top: 20px; font-size: 20px">
    <div align="center">
      <h2 class="text-center" align="center">
        Leveraging Analytic Gradients in Provably Safe Reinforcement Learning
      </h2><br>
      <h6>
        <a href="https://www.ce.cit.tum.de/en/cps/members/tim-walter/">Tim
          Walter</a><sup>1</sup>&nbsp;&nbsp;&nbsp;&nbsp;
        <a href="https://www.ce.cit.tum.de/cps/members/hannah-markgraf-msc/">Hannah
          Markgraf</a><sup>†1</sup>&nbsp;&nbsp;&nbsp;&nbsp;
        <a href="https://www.ce.cit.tum.de/cps/members/jonathan-kuelz/">Jonathan
          Külz</a><sup>†1,2</sup>&nbsp;&nbsp;&nbsp;&nbsp;
        <a href="https://www.ce.cit.tum.de/cps/members/prof-dr-ing-matthias-althoff/">Matthias
          Althoff</a><sup>1,2</sup>&nbsp;&nbsp;&nbsp;&nbsp;
      </h6>
      <small>
        <sup>†</sup> Equal Contribution &nbsp;&nbsp;&nbsp;&nbsp;
        <sup>1</sup> Technical University of Munich (TUM) &nbsp;&nbsp;&nbsp;&nbsp;
        <sup>2</sup> Munich Center for Machine Learning (MCML) &nbsp;&nbsp;&nbsp;&nbsp;
    </div>
  </div><br>

  <div class="container" style="padding-top: 10px; font-size: 20px">
    <div align="center">
      <div class="center">
        <img class="img-responsive img-rounded" data-theme-img data-light="pipeline.svg" data-dark="pipeline_dark.svg"
          src="pipeline.svg" style="width:80%" alt="Pipeline">
      </div>
    </div>
  </div><br><br>


  <!-- Abstract -->
  <div class="container">
    <h4 id="Abstract" style="padding-top: 70px; margin-top: -80px; ">Abstract</h4>
    <hr>
    <div style="text-align: justify">
      The deployment of autonomous robots in safety-critical applications requires safety guarantees. Provably safe
      reinforcement learning is an active field of research that aims to provide such guarantees using safeguards. These
      safeguards should be integrated during training to reduce the sim-to-real gap. While there are several approaches
      for safeguarding sampling-based reinforcement learning, analytic gradient-based reinforcement learning often
      achieves superior performance from fewer environment interactions. However, there is no safeguarding approach for
      this learning paradigm yet. Our work addresses this gap by developing the first effective safeguard for analytic
      gradient-based reinforcement learning. We analyse existing, differentiable safeguards, adapt them through modified
      mappings and gradient formulations, and integrate them into a state-of-the-art learning algorithm and a
      differentiable simulation. Using numerical experiments on three control tasks, we evaluate how different
      safeguards affect learning. The results demonstrate safeguarded training without compromising performance.
    </div>
  </div><br><br>

  <!-- Paper -->
  <div class="container" style="font-size: 15px">
    <h4 id="Paper" style="padding-top: 70px; margin-top: -80px;">Paper</h4>
    <hr>

    <div class="row">
      <div class="col-md-12">
        <b>Leveraging Analytic Gradients in Provably Safe Reinforcement Learning</b><br>

        <a href="https://www.ce.cit.tum.de/en/cps/members/tim-walter/">Tim Walter</a>
        <a href="https://www.ce.cit.tum.de/cps/members/hannah-markgraf-msc/">Hannah Markgraf</a>
        <a href="https://www.ce.cit.tum.de/cps/members/jonathan-kuelz/">Jonathan Külz</a>
        <a href="https://www.ce.cit.tum.de/cps/members/prof-dr-ing-matthias-althoff/">Matthias Althoff</a>

        <i><a target="_blank" href="https://ojcsys.github.io/">
            <font color="gray">IEEE Open Journal of Control Systems (OJ-CSYS) 2025 </font>
          </a></i><br>
        <a target="_blank" href="https://openreview.net/forum?id=ZSKRQMvttc">[Paper]</a>&nbsp; <!-- TODO -->
        <a target="_blank" href="https://arxiv.org/abs/2506.01665">[Arxiv]</a>&nbsp;
        <a target="_blank" href="https://github.com/TimWalter/SafeGBPO">[Code]</a>&nbsp;
        <a href="#" role="button" data-bs-toggle="modal" data-bs-target="#bibtex">[BibTeX]</a>&nbsp;
        <!-- Modal -->
        <div class="modal fade" id="bibtex" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
          aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="bibtex-title">BibTeX</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <!-- Modal body snippet -->
              <div class="modal-body">
                <div class="code-block-wrapper">
                  <pre id="bibtex-content" class="bibtex-pre"><code>@article{walter2025leveraging, <!-- TODO -->
  author = {Walter, Tim and Markgraf, Hannah and K{\\"u}lz, Jonathan and Althoff, Matthias},
  doi = {10.1109/OJCSYS.2025.}, <!-- TODO -->
  journaltitle = {{IEEE} Open Journal of Control Systems},
  pages = {},<!-- TODO -->
  title = {Leveraging Analytic Gradients in Provably Safe Reinforcement Learning},
  volume = {1}, <!-- TODO -->
  year = {2025},
}</code></pre>
                  <button type="button" id="copy-bibtex" class="copy-icon-btn" aria-label="Copy BibTeX"
                    title="Copy BibTeX">
                    <i class="far fa-clone"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div><br><br>

  <!-- Results -->
  <div class="container">
    <h4 id="Results" style="padding-top: 30px; margin-top: -40px;">Results</h4>
    <hr>
    <br>
    <h5> Learning with Short-Horizon Actor-Critic in unsafe training and safeguarded training. </h5>
    <br>
    <figure class="figure">
      <img data-theme-img data-light="main_results.svg" data-dark="main_results_dark.svg" src="main_results.svg"
        class="figure-img img-fluid rounded" alt="Main Results">
    </figure>
  </div><br><br><br>

  <!-- Additional Results -->
  <div class="container">
    <h4 id="Additional Results" style="padding-top: 30px; margin-top: -40px;">Additional Results</h4>
    <hr>
    <br>
    <h5> Additional Evaluation Problem 1: Seeker Navigate </h5> <br>
    <!-- TODO -->
    TODO
    <!--<div class="row">
      <figure class="figure col-lg-4">
        <img src="videos/cartpole_0.gif" class="figure-img img-fluid rounded">
        <figcaption style="font-family:'Times New Roman';font-size:20px" class="figure-caption text-center">Episode 0
        </figcaption>
      </figure>
      <figure class="figure col-lg-4">
        <img src="videos/cartpole_1.gif" class="figure-img img-fluid rounded">
        <figcaption style="font-family:'Times New Roman';font-size:20px" class="figure-caption text-center">Episode 50
        </figcaption>
        <figcaption style="font-family:'Times New Roman';font-size:20px" class="figure-caption text-center">(36 seconds
          of training)</figcaption>
      </figure>
      <figure class="figure col-lg-4">
        <img src="videos/cartpole_2.gif" class="figure-img img-fluid rounded">
        <figcaption style="font-family:'Times New Roman';font-size:20px" class="figure-caption text-center">Episode 100
        </figcaption>
        <figcaption style="font-family:'Times New Roman';font-size:20px" class="figure-caption text-center">(72 seconds
          of training)</figcaption>
      </figure>
    </div>-->
  </div><br><br><br>

  <!-- Footer -->
  <footer class="text-center text-muted mt-5 mb-3">
    © 2025 Tim Walter — <a href="mailto:tim.walter@tum.de">Contact</a>
  </footer>



  <!-- Bootstrap core JavaScript -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
    crossorigin="anonymous"></script>
  <script>
    // Copy BibTeX button logic (updated to target only <code>)
    (function () {
      var btn = document.getElementById('copy-bibtex');
      if (!btn) return;
      var original = btn.innerHTML;
      var timeoutId = null;

      function indicateCopied() {
        btn.classList.add('copied');
        btn.innerHTML = '<i class="fas fa-check"></i>';
        clearTimeout(timeoutId);
        timeoutId = setTimeout(function () {
          btn.classList.remove('copied');
          btn.innerHTML = original;
        }, 1500);
      }

      btn.addEventListener('click', function () {
        var codeEl = document.querySelector('#bibtex-content code');
        if (!codeEl) return;
        var text = codeEl.innerText.trim();

        function fallback() {
          var ta = document.createElement('textarea');
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try {
            document.execCommand('copy');
            indicateCopied();
          } catch (e) { /* silent */ }
          document.body.removeChild(ta);
        }

        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(text).then(indicateCopied).catch(fallback);
        } else {
          fallback();
        }
      });
    })();
  </script>
  <script>
(function () {
  var STORAGE_KEY = 'color-mode';
  var toggle = document.getElementById('theme-toggle');

  function systemMode() {
    return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  }
  function storedMode() {
    return localStorage.getItem(STORAGE_KEY); // 'dark' | 'light' | null
  }

  function swapThemeImages(mode) {
    document.querySelectorAll('[data-theme-img]').forEach(function(img){
      var lightSrc = img.getAttribute('data-light');
      var darkSrc  = img.getAttribute('data-dark');

      // Heuristic fallback: if no data-dark but file.svg exists and file_dark.svg likely exists
      if (!darkSrc && lightSrc && lightSrc.endsWith('.svg')) {
        var guess = lightSrc.replace(/\.svg$/,'_dark.svg');
        if (guess !== lightSrc) darkSrc = guess;
      }

      var target = (mode === 'dark') ? darkSrc : lightSrc;
      if (target && img.getAttribute('src') !== target) {
        img.setAttribute('src', target);
      }
    });
  }

  function apply(mode) {
    document.documentElement.setAttribute('data-bs-theme', mode);
    if (toggle) {
      // checked = dark
      if (!storedMode()) {
        toggle.checked = (systemMode() === 'dark');
      } else {
        toggle.checked = (mode === 'dark');
      }
    }
    swapThemeImages(mode);
    // Custom event if you later want others to listen
    document.dispatchEvent(new CustomEvent('theme-changed', { detail: { mode: mode }}));
  }

  function setOverride(valOrNull) {
    if (valOrNull === null) {
      localStorage.removeItem(STORAGE_KEY);
      apply(systemMode());
    } else {
      localStorage.setItem(STORAGE_KEY, valOrNull);
      apply(valOrNull);
    }
  }

  // Initial
  apply(storedMode() || systemMode());

  // System changes (only when no stored override)
  var mq = window.matchMedia('(prefers-color-scheme: dark)');
  mq.addEventListener('change', function (e) {
    if (!storedMode()) {
      apply(e.matches ? 'dark' : 'light');
    }
  });

  if (toggle) {
    toggle.addEventListener('change', function () {
      var wantingDark = toggle.checked;
      setOverride(wantingDark ? 'dark' : 'light');
    });
  }

  // If images load after script (rare), ensure a late pass
  window.addEventListener('load', function(){
    swapThemeImages(document.documentElement.getAttribute('data-bs-theme'));
  });
})();
</script>
</body>

</html>